version: '3.8'

services:
  # â˜• ìŠ¤í”„ë§ ë¶€íŠ¸ (ë°±ì—”ë“œ)
  backend:
    build: ./backend
    ports:
      - "8080:8080"
    env_file:
      - .env  # EC2ì˜ .env ë‚´ìš©ì„ ê°€ì ¸ì˜´
    volumes:
      # EC2ì˜ firebase íŒŒì¼ì„ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ /app í´ë”ë¡œ ì—°ê²°
      - ./firebase-service-account.json:/app/firebase-service-account.json
    depends_on:
      - ai-server
    restart: always

  # ğŸ AI ì„œë²„
  ai-server:
    build: ./Analysis
    ports:
      - "8000:8000"
    env_file:
      - .env  # ê°™ì€ .env ì‚¬ìš©
    restart: always